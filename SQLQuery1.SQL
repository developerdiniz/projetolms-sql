
-- TABELA CARGO 
IF EXISTS (SELECT * FROM SYS.tables WHERE name = 'TABELACAR')
	DROP TABLE TABELACAR;

CREATE TABLE TABELACAR
( 
	COD_CARGO		INT IDENTITY,
	CARGO			VARCHAR(30) NOT NULL,
	SALARIO_INIC	NUMERIC(10,2),

	CONSTRAINT PK_TABELACAR PRIMARY KEY (COD_CARGO)
);

-- TABELA DEPARTAMENTO 
IF EXISTS (SELECT * FROM SYS.tables WHERE name = 'TABELADEP')
	DROP TABLE TABELADEP;

CREATE TABLE TABELADEP
( 
	COD_DEPTO		INT IDENTITY,
	DEPTO			VARCHAR(30) NOT NULL,

	CONSTRAINT PK_TABELADEP PRIMARY KEY (COD_DEPTO)
);

-- TABELA EMPREGADOS
IF EXISTS (SELECT * FROM SYS.tables WHERE name = 'EMPREGADOS')
	DROP TABLE EMPREGADOS;

CREATE TABLE EMPREGADOS
(
	CODFUN				INT IDENTITY PRIMARY KEY,
	NOME				VARCHAR(50) NOT NULL,
	NUM_DEPEND			TINYINT NOT NULL,
	DATA_NASCIMENTO		DATE	NOT NULL,
	COD_DEPTO			INT NOT NULL,
	COD_CARGO			INT NOT NULL,
	DATA_ADMISSAO		DATETIME NOT NULL,
	SALARIO				NUMERIC(10,2) NOT NULL,
	SINDICALIZADO		CHAR(1) NOT NULL,
	OBS					VARCHAR(8000),

	CONSTRAINT FK_EMP_CARGO FOREIGN KEY (COD_CARGO) 
		REFERENCES TABELACAR (COD_CARGO),

	CONSTRAINT FK_EMP_DEPTO FOREIGN KEY (COD_DEPTO) 
		REFERENCES TABELADEP (COD_DEPTO)
);


-- TABELA DEPENDENTES
IF EXISTS (SELECT * FROM SYS.tables WHERE name = 'DEPENDENTES')
	DROP TABLE DEPENDENTES;

CREATE TABLE DEPENDENTES
(
	CODFUN				INT,
	CODDEP				INT,
	NOME				VARCHAR(50) NOT NULL,			
	DATA_NASCIMENTO			DATETIME    NOT NULL,
	
	CONSTRAINT PK_DEPENDENTES PRIMARY KEY (CODFUN, CODDEP) ,

	CONSTRAINT FK_DEP_EMPREGADOS FOREIGN KEY (CODFUN) 
		REFERENCES EMPREGADOS (CODFUN)
);

ALTER TABLE EMPREGADOS ADD
	CONSTRAINT CK_SINDICALIZADO
		CHECK (SINDICALIZADO IN ('S','N')),
		CONSTRAINT DF_SINDICALIZADO DEFAULT ('S') FOR SINDICALIZADO,
	CONSTRAINT CK_SALARIO
		CHECK (SALARIO > 500),
	CONSTRAINT CK_DATA_NASCIMENTO
		CHECK (DATA_NASCIMENTO > '1900/01/01' AND DATA_NASCIMENTO <'2500/12/31');

ALTER TABLE EMPREGADOS
	DROP COLUMN OBS;


ALTER TABLE TABELACAR
 SALARIO_INIC ADD NOT NULL



ALTER TABLE DEPENDENTES
	CONSTRAINT CK_DATA_NASCIMENTO 
	
ALTER TABLE TabelaDep 
	ADD ANDAR (TINYINT);

		



		



